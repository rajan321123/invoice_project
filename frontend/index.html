<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice QC Console</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen text-slate-900">

    <!-- Header -->
    <header class="bg-white border-b border-slate-200 shadow-sm sticky top-0 z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="bg-indigo-600 p-2 rounded-lg">
                    <svg class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                </div>
                <h1 class="text-xl font-bold text-slate-900 tracking-tight">Invoice QC Console</h1>
            </div>
            <div class="text-sm text-slate-500 bg-slate-100 px-3 py-1 rounded-full">
                API Status: <span id="api-status" class="font-semibold text-yellow-600">Connecting...</span>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Input Section -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden mb-8">
            <div class="border-b border-slate-200 bg-slate-50 px-6 py-4 flex items-center justify-between">
                <div class="flex space-x-4">
                    <button id="tab-pdf" class="px-4 py-2 text-sm font-medium text-indigo-600 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-indigo-500">
                        Upload PDFs
                    </button>
                    <button id="tab-json" class="px-4 py-2 text-sm font-medium text-slate-600 hover:text-slate-900 transition-colors focus:outline-none">
                        Paste JSON
                    </button>
                </div>
            </div>

            <div class="p-6">
                <!-- PDF Upload Form -->
                <div id="panel-pdf" class="block">
                    <div class="flex flex-col items-center justify-center border-2 border-dashed border-slate-300 rounded-lg p-10 hover:bg-slate-50 transition-colors cursor-pointer relative">
                        <input type="file" id="file-input" multiple accept=".pdf" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                        <svg class="h-10 w-10 text-indigo-500 mb-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                        </svg>
                        <p class="text-sm font-medium text-slate-700">Drag & drop PDF invoices or click to browse</p>
                        <p class="text-xs text-slate-500 mt-1">Supported formats: PDF</p>
                        <p id="file-count" class="text-xs font-semibold text-indigo-600 mt-2 hidden">0 files selected</p>
                    </div>
                    <div class="mt-4 flex justify-end">
                        <button id="btn-upload" class="bg-indigo-600 text-white px-5 py-2.5 rounded-lg text-sm font-medium shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                            Extract & Validate
                        </button>
                    </div>
                </div>

                <!-- JSON Input Form -->
                <div id="panel-json" class="hidden">
                    <label for="json-input" class="block text-sm font-medium text-slate-700 mb-2">Paste Invoice JSON</label>
                    <textarea id="json-input" rows="8" class="block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm font-mono p-3 bg-slate-50" placeholder='[{"invoice_number": "...", ...}]'></textarea>
                    <div class="mt-4 flex justify-end">
                        <button id="btn-validate-json" class="bg-indigo-600 text-white px-5 py-2.5 rounded-lg text-sm font-medium shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                            Validate JSON
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Progress Bar -->
            <div id="progress-container" class="hidden border-t border-slate-200 bg-slate-50 px-6 py-4">
                 <div class="w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700">
                    <div id="progress-bar" class="bg-indigo-600 h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
                </div>
                <p class="text-center text-xs text-slate-500 mt-2">Processing...</p>
            </div>
        </div>

        <!-- Filters & Sort -->
        <div id="results-controls" class="flex flex-col sm:flex-row justify-between items-center mb-4 hidden">
            <div class="flex items-center space-x-2 mb-2 sm:mb-0">
                <h2 class="text-lg font-bold text-slate-800">Results</h2>
                <span id="results-count" class="bg-slate-200 text-slate-600 text-xs font-semibold px-2 py-0.5 rounded-full">0</span>
            </div>
            
            <div class="flex items-center space-x-4">
                <label class="inline-flex items-center cursor-pointer">
                    <input type="checkbox" id="toggle-invalid" class="sr-only peer">
                    <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-red-100 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-500"></div>
                    <span class="ms-3 text-sm font-medium text-slate-700">Show Invalid Only</span>
                </label>
                
                <select id="sort-select" class="block w-40 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm py-2 px-3 bg-white">
                    <option value="status">Sort by Status</option>
                    <option value="id">Sort by Invoice #</option>
                </select>
            </div>
        </div>

        <!-- Results Table -->
        <div id="results-container" class="hidden bg-white shadow-sm rounded-xl border border-slate-200 overflow-hidden">
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-slate-200">
                    <thead class="bg-slate-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Status</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Invoice #</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Date</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Seller</th>
                            <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider">Amount</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Issues</th>
                        </tr>
                    </thead>
                    <tbody id="results-body" class="bg-white divide-y divide-slate-200">
                        <!-- Rows will be injected here -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Empty State -->
        <div id="empty-state" class="text-center py-12 md:py-20">
            <div class="bg-slate-50 rounded-full p-4 w-16 h-16 mx-auto flex items-center justify-center mb-4">
                <svg class="h-8 w-8 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                </svg>
            </div>
            <h3 class="text-lg font-medium text-slate-900">No data yet</h3>
            <p class="text-slate-500 max-w-sm mx-auto mt-1">Upload invoices or paste JSON data to see the quality control results here.</p>
        </div>

    </main>
    
    <!-- Modal for JSON Data -->
    <div id="data-modal" class="fixed inset-0 bg-slate-900/50 hidden z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[80vh] flex flex-col">
            <div class="px-6 py-4 border-b border-slate-200 flex justify-between items-center">
                <h3 class="text-lg font-semibold text-slate-900" id="modal-title">Invoice Data</h3>
                <button id="close-modal" class="text-slate-400 hover:text-slate-600">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="p-6 overflow-auto bg-slate-50 font-mono text-xs">
                <pre id="modal-content"></pre>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
